@using RestaurantMVC.ViewModels
@model RestaurantMVC.ViewModels.ManageTableVM

<div class="container my-4">
    <h2 class="text-center mb-4 text-light">Handle Tables</h2>

    <div class="mb-4">
        <button class="btn btn-success mb-3" type="button" data-bs-toggle="collapse" data-bs-target="#createItem" aria-expanded="false" aria-controls="createItem">
            <i class="fas fa-plus-circle me-2"></i> Create Table
        </button>

        <div id="createItem" class="collapse">
            <div class="card bg-dark border-secondary shadow-lg">
                <div class="card-header bg-success text-light border-secondary">
                    <h4 class="mb-0">
                        <i class="fas fa-utensils me-2"></i> New Table
                    </h4>
                </div>
                <div class="card-body bg-dark">
                    @{
                        ViewData["FormAction"] = "CreateTable";
                    }
                    <partial name="_TableForm" model="Model.NewTable" />
                </div>
            </div>
        </div>
    </div>

    <div class="card bg-dark border-secondary shadow-lg">
        <div class="card-header bg-primary text-light">
            <h4 class="mb-0"><i class="fas fa-chair me-2"></i> Existing Tables</h4>
        </div>
        <div class="card-body bg-dark">
            <div class="table-responsive">
                <table class="table table-dark table-striped table-hover align-middle">
                    <thead class="table-secondary text-dark">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Table Number</th>
                            <th scope="col">Capacity</th>
                            <th scope="col" class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Tables)
                        {
                            <tr>
                                <td>@item.Id</td>
                                <td>@item.TableNumber</td>
                                <td>@item.Capacity</td>
                                <td class="text-center">
        
                                    <button class="btn btn-warning btn-sm me-2" type="button"
                                            data-bs-toggle="collapse"
                                            data-bs-target="#editForm-@item.Id"
                                            aria-expanded="false"
                                            aria-controls="editForm-@item.Id">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>

                                    <form asp-controller="Table" asp-action="DeleteTable" method="post" asp-route-id="@item.Id" class="d-inline">
                                        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this table?');">
                                            <i class="fas fa-trash-alt"></i> Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            <tr class="collapse bg-secondary" id="editForm-@item.Id">
                                <td colspan="4">
                                    <div class="card card-body bg-dark border-light">
                                        @{
                                            ViewData["FormAction"] = "Edit";
                                            var editModel = new TableVM
                                            {
                                                Id = item.Id,
                                                Capacity = item.Capacity,
                                                TableNumber = item.TableNumber
                                            };
                                        }
                                        <partial name="_TableForm" model="editModel" />
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
